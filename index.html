<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TRIP UA</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

        :root {
            --bg: #101010;
            --bg-card: #1a1a1a;
            --bg-card-hover: #222222;
            --text: #e8e8e8;
            --text-dim: #888888;
            --text-muted: #555555;
            --border: #1f1f1f;
            --card-radius: 14px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .snow-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; overflow: hidden; }
        .snowflake { position: absolute; top: -10px; background: rgba(255,255,255,0.8); border-radius: 50%; pointer-events: none; animation: fall linear infinite; }
        @keyframes fall {
            0% { transform: translateY(-10px) translateX(0); opacity: 1; }
            25% { transform: translateY(25vh) translateX(15px); }
            50% { transform: translateY(50vh) translateX(-10px); opacity: 0.8; }
            75% { transform: translateY(75vh) translateX(20px); }
            100% { transform: translateY(105vh) translateX(-5px); opacity: 0; }
        }

        .header { position: sticky; top: 0; z-index: 100; background: rgba(16,16,16,0.92); backdrop-filter: blur(24px); -webkit-backdrop-filter: blur(24px); padding: 16px 20px; border-bottom: 1px solid var(--border); }
        .header-inner { display: flex; align-items: center; justify-content: center; position: relative; }
        .back-btn { position: absolute; left: 0; display: flex; align-items: center; gap: 4px; background: none; border: none; color: var(--text-dim); font-family: 'Inter', sans-serif; font-size: 14px; font-weight: 500; cursor: pointer; padding: 4px 0; }
        .back-btn svg { width: 20px; height: 20px; fill: var(--text-dim); }
        .back-btn:active { opacity: 0.6; }
        .logo { display: flex; align-items: center; gap: 12px; }
        .logo-mark { width: 36px; height: 36px; border-radius: 10px; background: #fff; display: flex; align-items: center; justify-content: center; }
        .logo-mark svg { width: 20px; height: 20px; fill: #101010; }
        .logo-text { font-size: 20px; font-weight: 800; letter-spacing: -0.3px; color: #fff; }
        .logo-text span { font-weight: 400; color: var(--text-dim); }

        .hero { padding: 48px 24px 32px; text-align: center; }
        .hero-badge { display: inline-block; padding: 6px 16px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.08); border-radius: 100px; font-size: 12px; color: var(--text-dim); letter-spacing: 0.5px; margin-bottom: 20px; }
        .hero h1 { font-size: 32px; font-weight: 900; line-height: 1.15; letter-spacing: -0.5px; color: #fff; margin-bottom: 10px; }
        .hero p { font-size: 15px; color: var(--text-muted); line-height: 1.5; max-width: 300px; margin: 0 auto; }

        .section-header { display: flex; align-items: center; justify-content: space-between; padding: 28px 20px 16px; }
        .section-title { font-size: 13px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; color: var(--text-dim); }
        .item-count { font-size: 12px; color: var(--text-muted); background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 20px; }

        .card-list { padding: 0 16px 120px; display: flex; flex-direction: column; gap: 8px; }
        .card { display: flex; align-items: center; gap: 14px; padding: 14px; background: var(--bg-card); border-radius: var(--card-radius); border: 1px solid var(--border); cursor: pointer; transition: background 0.15s ease, transform 0.15s ease; text-decoration: none; color: inherit; -webkit-user-select: none; user-select: none; opacity: 0; transform: translateY(16px); }
        .card.visible { opacity: 1; transform: translateY(0); transition: opacity 0.4s ease, transform 0.4s ease, background 0.15s ease; }
        .card:active { background: var(--bg-card-hover); transform: scale(0.98) translateY(0) !important; }
        .card-icon { width: 50px; height: 50px; border-radius: 14px; background: rgba(255,255,255,0.04); display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0; }
        .card-content { flex: 1; min-width: 0; }
        .card-name { font-size: 15px; font-weight: 600; color: #fff; margin-bottom: 3px; }
        .card-desc { font-size: 13px; color: var(--text-muted); }
        .card-arrow { flex-shrink: 0; width: 32px; height: 32px; border-radius: 50%; background: rgba(255,255,255,0.05); display: flex; align-items: center; justify-content: center; transition: background 0.15s ease; }
        .card:active .card-arrow { background: rgba(255,255,255,0.1); }
        .card-arrow svg { width: 16px; height: 16px; fill: var(--text-muted); }

        .view { display: none; }
        .view.active { display: block; }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; text-align: center; padding: 20px; padding-bottom: max(20px, env(safe-area-inset-bottom)); background: linear-gradient(to top, var(--bg) 50%, transparent); pointer-events: none; z-index: 50; }
        .footer p { font-size: 11px; color: var(--text-muted); letter-spacing: 0.3px; }
        .glow { position: absolute; top: -100px; left: 50%; transform: translateX(-50%); width: 300px; height: 300px; background: radial-gradient(circle, rgba(255,255,255,0.025) 0%, transparent 70%); pointer-events: none; z-index: 0; }
    </style>
</head>
<body>

    <div class="snow-container" id="snowContainer"></div>
    <div class="glow"></div>

    <!-- VIEW: REGIONS -->
    <div id="viewRegions" class="view active">
        <div class="header"><div class="header-inner">
            <div class="logo"><div class="logo-mark"><svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg></div><div class="logo-text">TRIP <span>UA</span></div></div>
        </div></div>
        <div class="hero">
            <div class="hero-badge">‚ùÑÔ∏è –ó–∏–º–∞ 2026</div>
            <h1>–û–±–µ—Ä–∏<br>–æ–±–ª–∞—Å—Ç—å</h1>
            <p>–ó–Ω–∞–π–¥–∏ –Ω–∞–π–∫—Ä–∞—â—ñ –º–∞–≥–∞–∑–∏–Ω–∏<br>—É —Å–≤–æ—î–º—É —Ä–µ–≥—ñ–æ–Ω—ñ</p>
        </div>
        <div class="section-header">
            <div class="section-title">–û–±–ª–∞—Å—Ç—ñ</div>
            <div class="item-count" id="regionCount"></div>
        </div>
        <div class="card-list" id="regionList"></div>
    </div>

    <!-- VIEW: CITIES -->
    <div id="viewCities" class="view">
        <div class="header"><div class="header-inner">
            <button class="back-btn" onclick="showRegions()"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>–ù–∞–∑–∞–¥</button>
            <div class="logo"><div class="logo-mark"><svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg></div><div class="logo-text">TRIP <span>UA</span></div></div>
        </div></div>
        <div class="hero">
            <div class="hero-badge" id="citiesBadge"></div>
            <h1>–û–±–µ—Ä–∏<br>–º—ñ—Å—Ç–æ</h1>
            <p>–ú–∞–≥–∞–∑–∏–Ω–∏ —É –º—ñ—Å—Ç–∞—Ö<br>—Ç–≤–æ—î—ó –æ–±–ª–∞—Å—Ç—ñ</p>
        </div>
        <div class="section-header">
            <div class="section-title">–ú—ñ—Å—Ç–∞</div>
            <div class="item-count" id="cityCount"></div>
        </div>
        <div class="card-list" id="cityList"></div>
    </div>

    <!-- VIEW: SHOPS -->
    <div id="viewShops" class="view">
        <div class="header"><div class="header-inner">
            <button class="back-btn" onclick="showCities(currentRegionId)"><svg viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>–ù–∞–∑–∞–¥</button>
            <div class="logo"><div class="logo-mark"><svg viewBox="0 0 24 24"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"/></svg></div><div class="logo-text">TRIP <span>UA</span></div></div>
        </div></div>
        <div class="hero">
            <div class="hero-badge" id="shopsBadge"></div>
            <h1>–°–ø–∏—Å–æ–∫<br>–ú–∞–≥–∞–∑–∏–Ω—ñ–≤</h1>
            <p>–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –º–∞–≥–∞–∑–∏–Ω–∏ –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏<br>—Ç–æ–≤–∞—Ä–∞–º–∏ —Ç–∞ —Å–µ—Ä–≤—ñ—Å–æ–º</p>
        </div>
        <div class="section-header">
            <div class="section-title">–ú–∞–≥–∞–∑–∏–Ω–∏</div>
            <div class="item-count" id="shopCount"></div>
        </div>
        <div class="card-list" id="shopList"></div>
    </div>

    <div class="footer"><p>TRIP UA ¬∑ 2026</p></div>

    <script>
        const tg = window.Telegram?.WebApp;
        if (tg) { tg.ready(); tg.expand(); tg.setHeaderColor('#101010'); tg.setBackgroundColor('#101010'); }

        // ===== DATA (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ webapp_data.json, —è–∫–∏–π –≥–µ–Ω–µ—Ä—É—î –±–æ—Ç –∑ –ë–î) =====
        let data = { regions: [] };

        async function loadData() {
            try {
                const res = await fetch('webapp_data.json', { cache: 'no-store' });
                const json = await res.json();
                // –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç: { regions: [...] }
                data = json && Array.isArray(json.regions) ? json : { regions: [] };
            } catch (e) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è webapp_data.json', e);
                data = { regions: [] };
            }
        }

        let currentRegionId = null;
        const arrowSvg = `<svg viewBox="0 0 24 24"><path d="M9.29 6.71a1 1 0 0 0 0 1.41L13.17 12l-3.88 3.88a1 1 0 1 0 1.41 1.41l4.59-4.59a1 1 0 0 0 0-1.41L10.7 6.7a1 1 0 0 0-1.41.01z"/></svg>`;

        function switchView(id) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0, 0);
        }

        function animateCards(containerId) {
            requestAnimationFrame(() => {
                document.getElementById(containerId).querySelectorAll('.card').forEach((c, i) => {
                    setTimeout(() => c.classList.add('visible'), i * 50);
                });
            });
        }

        function showRegions() {
            currentRegionId = null;
            switchView('viewRegions');
            if (tg) tg.BackButton.hide();
        }

        function showCities(regionId) {
            currentRegionId = regionId;
            const region = data.regions.find(r => r.id === regionId);
            if (!region) return;

            document.getElementById('citiesBadge').textContent = 'üìç ' + region.name;
            document.getElementById('cityCount').textContent = region.cities.length + ' –º—ñ—Å—Ç';
            document.getElementById('cityList').innerHTML = region.cities.map(city => `
                <div class="card" onclick="showShops('${regionId}','${city.id}')">
                    <div class="card-icon">${city.emoji}</div>
                    <div class="card-content">
                        <div class="card-name">${city.name}</div>
                        <div class="card-desc">${city.desc}</div>
                    </div>
                    <div class="card-arrow">${arrowSvg}</div>
                </div>
            `).join('');

            switchView('viewCities');
            animateCards('cityList');
            if (tg) { tg.BackButton.show(); tg.BackButton.onClick(showRegions); }
        }

        function showShops(regionId, cityId) {
            currentRegionId = regionId;
            const region = data.regions.find(r => r.id === regionId);
            const city = region?.cities.find(c => c.id === cityId);
            if (!city) return;

            document.getElementById('shopsBadge').textContent = 'üìç ' + city.name;
            document.getElementById('shopCount').textContent = city.shops.length + ' –º—ñ—Å—Ü—å';
            document.getElementById('shopList').innerHTML = city.shops.map(shop => `
                <a href="${shop.telegram}" target="_blank" rel="noopener" class="card">
                    <div class="card-icon">${shop.emoji}</div>
                    <div class="card-content">
                        <div class="card-name">${shop.name}</div>
                        <div class="card-desc">${shop.desc}</div>
                    </div>
                    <div class="card-arrow">${arrowSvg}</div>
                </a>
            `).join('');

            switchView('viewShops');
            animateCards('shopList');
            if (tg) { tg.BackButton.show(); tg.BackButton.onClick(() => showCities(regionId)); }
        }

        function renderRegions() {
            const regions = Array.isArray(data.regions) ? data.regions : [];
            document.getElementById('regionCount').textContent = regions.length + ' –æ–±–ª.';
            document.getElementById('regionList').innerHTML = regions.map(r => `
                <div class="card" onclick="showCities('${r.id}')">
                    <div class="card-icon">${r.emoji}</div>
                    <div class="card-content">
                        <div class="card-name">${r.name}</div>
                        <div class="card-desc">${r.desc}</div>
                    </div>
                    <div class="card-arrow">${arrowSvg}</div>
                </div>
            `).join('');
            animateCards('regionList');
        }

        function createSnow() {
            const c = document.getElementById('snowContainer');
            for (let i = 0; i < 45; i++) {
                const f = document.createElement('div');
                f.classList.add('snowflake');
                const s = Math.random() * 3 + 1;
                f.style.width = s+'px'; f.style.height = s+'px';
                f.style.left = Math.random()*100+'%';
                f.style.animationDuration = (Math.random()*8+6)+'s';
                f.style.animationDelay = (Math.random()*12)+'s';
                f.style.opacity = Math.random()*0.4+0.15;
                c.appendChild(f);
            }
        }

        (async () => {
            createSnow();
            await loadData();
            renderRegions();
        })();
    </script>
</body>
</html>
